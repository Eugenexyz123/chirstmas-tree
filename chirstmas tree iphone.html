<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Grand Luxury Tree - Mobile v17.6.5</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto; }
        #canvas-container { width: 100vw; height: 100vh; }
        /* ç§»åŠ¨ç«¯æµ®åŠ¨èœå• - é€‚é…åˆ˜æµ·å± */
        .mobile-ui {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 10px; z-index: 100; padding: 10px;
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .ui-btn {
            background: none; border: none; color: gold; font-size: 14px;
            padding: 8px 15px; cursor: pointer;
        }
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 1000;
        }
        .spinner { width: 40px; height: 40px; border: 2px solid gold; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <div style="color: gold; margin-top: 15px; letter-spacing: 2px;">LOADING...</div>
</div>

<div id="canvas-container"></div>

<div class="mobile-ui">
    <button class="ui-btn" onclick="setMode('TREE')">ğŸ„ èšåˆ</button>
    <button class="ui-btn" onclick="setMode('SCATTER')">âœ¨ æ•£å¼€</button>
    <button class="ui-btn" onclick="toggleMusic()">ğŸµ éŸ³ä¹</button>
</div>

<script type="importmap">
{
    "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
    }
}
</script>

<script type="module">
import * as THREE from 'three';
// ç§»åŠ¨ç«¯ä¸“ç”¨æ¸²æŸ“é€»è¾‘
let scene, camera, renderer, particles = [];
let mode = 'TREE';

function init() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.z = 30;

    renderer = new THREE.WebGLRenderer({ antialias: true, powerPreference: "high-performance" });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    document.getElementById('canvas-container').appendChild(renderer.domElement);

    // åˆ›å»ºç²’å­æ ‘
    const geometry = new THREE.SphereGeometry(0.2, 8, 8);
    const material = new THREE.MeshBasicMaterial({ color: 0xffd700 });

    for (let i = 0; i < 1000; i++) {
        const mesh = new THREE.Mesh(geometry, material);
        const p = {
            mesh: mesh,
            targetPos: new THREE.Vector3(),
            scatterPos: new THREE.Vector3((Math.random()-0.5)*40, (Math.random()-0.5)*40, (Math.random()-0.5)*40)
        };
        
        // æ ‘å½¢ç®—æ³•
        const h = Math.random() * 20;
        const r = (20 - h) * 0.3;
        const a = Math.random() * Math.PI * 2;
        p.targetPos.set(Math.cos(a) * r, h - 10, Math.sin(a) * r);
        
        scene.add(mesh);
        particles.push(p);
    }

    document.getElementById('loader').style.display = 'none';
    animate();
}

function animate() {
    requestAnimationFrame(animate);
    particles.forEach(p => {
        const dest = (mode === 'TREE') ? p.targetPos : p.scatterPos;
        p.mesh.position.lerp(dest, 0.05);
    });
    renderer.render(scene, camera);
}

window.setMode = (m) => { mode = m; };
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});

init();
</script>
</body>
</html>